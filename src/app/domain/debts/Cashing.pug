.uncashed

  .alert.alert-default

    .popovers.spaced
      a.popover-trigger(
      href
      popover-is-open='vm.isUncashingPopoverOpen'
      popover-placement='auto bottom-left'
      ng-class='{disabled: !!vm.uncashing}'
      uib-popover-template='"app/domain/debts/uncashingPopover.template.html"'
      )
        span.title
          currency-value(value='vm.totalCashed()' label='На руках:' ng-if='!vm.uncashingId')
          currency-value(
          value='vm.currentUncashing.summ'
          label='Сдано {{ vm.currentUncashing.date | amUtc| amLocal | amCalendar }}:'
          ng-if='vm.uncashingId'
          )
        span.caret

    .totals.buttons(ng-hide='vm.uncashingId')

      outlet-cashing-popover(
      comment-text-placeholder='Точка'
      is-popover-open='vm.plusPopoverOpen'
      )
        i.glyphicon.glyphicon-plus

      outlet-cashing-popover(
      summ-sign='-1'
      ndoc-placeholder='№ заявки'
      is-popover-open='vm.minusPopoverOpen'
      )
        i.glyphicon.glyphicon-minus

      a.btn.btn-link(href ng-click='vm.editClick()' ng-disabled='!vm.uncashed.length')
        i.glyphicon(ng-class='vm.editing ? "glyphicon-lock" : "glyphicon-edit"')

      uncash-popover(uncashed='vm.uncashed' ng-disabled='!vm.uncashed.length' is-popover-open='vm.uncashing')

  .scroll-y(
  resize resize-property='height'
  resize-offset-top='45'
  cg-busy='vm.cgBusy'
  )
    .outlet(ng-repeat='item in vm.uncashedByOutlet track by item.key')

      .title
        .name {{ item.title || item.outlet.name }}
        small.address
          a(href ng-click='vm.outletClick(item.outlet)') {{ item.outlet.address }}

      .cashings
        .cashing(ng-repeat='cashing in item.cashings track by cashing.id')
          .commentText {{ cashing.commentText }}
          .ndoc
            span {{ cashing.ndoc || cashing.debt.ndoc }}
            a.detete-btn(href ng-click='vm.deleteCashingClick(cashing)' ng-if='vm.editing')
              i.glyphicon.glyphicon-trash
          currency-value.summ(value='cashing.summ')
        .cashing.total(ng-if='item.cashings.length > 1')
          currency-value.summ(value='item.totalSumm')

    .empty(ng-if='!vm.busy && !vm.uncashed.length')
      .alert.alert-info.centered
        span Нет информации о собранной выручке. Регистрируйте выручку в разделе
        span &nbsp;
        a(href ui-sref='sales.debtByOutlet') Долги

  .footer

    .buttons

    .totals.animate-show(ng-hide='vm.busy')

      label Итого на руках:

      currency-value(value='vm.totalCashed()')
