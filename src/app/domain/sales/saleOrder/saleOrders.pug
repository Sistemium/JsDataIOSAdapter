section.ui-view.sale-orders(cg-busy='vm.cgBusy')

  display-workflow(
  workflows='vm.currentWorkflows'
  supplementary-workflow-data='vm.workflowDictionary'
  current-workflow='vm.currentWorkflow'
  )

  .headers
    .processing Статус
    .salesman(ng-if='!vm.currentSalesman') ТП
    .outlet Точка
    .totals Итоги

  #scroll-main.scroll-y(
  elem-ready='vm.restoreScrollPosition()'
  resize
  resize-offset-top='5'
  vs-repeat='{{vm.rowHeight()}}'
  vs-scrolled-to-end='vm.getData()'
  vs-scrolled-to-end-offset='15'
  vs-excess='10'
  )
    .clickable(
    ng-repeat='item in vm.data track by item.id'
    )
      .date(ng-if='!item.outletId')
        .title {{ ::item.date }}

      .sale-order(
      ng-if='item.outletId'
      ng-click='vm.itemClick(item)'
      )
        .row-data

          .processing(ng-class='item.workflowStep.cls')
            span {{ item.workflowStep.label }}

          .salesman(ng-if='!vm.currentSalesman')
            span.name {{ ::item.salesmanTinyName() }}

          .outlet
            span.name {{ ::item.outletName() }}
            .address
              .gray {{ ::item.outlet.address }}
              .salesman(ng-if='!vm.currentSalesman') {{ ::item.salesmanTinyName() }}

          .totals(ng-class='{"no-totals": !item.totalPositionsCached()}')
            .position
              strong {{ item.totalPositionsCached() || 0 }}
              span П
            .cost
              currency-value(
              value='item.totalCostCached() || 0'
              )

        .processing-message

          span {{ ::item.commentText }}
          span.icon(
          ng-if='item.processingMessage'
          ng-class='item.workflowStep.messageCls'
          )
            i.glyphicon.glyphicon-warning-sign
